class Popup extends HTMLElement{constructor(){super()}connectedCallback(){this.container=this.querySelector(".popup--container"),this.close_link=this.querySelector(".popup--close"),this.open_link=document.querySelector(".popup--open"),this.show_again_after=parseInt(this.getAttribute("data-show-again-after")),this.mode=this.getAttribute("data-mode"),this.newsletter_form=this.querySelector(".popup--newsletter-form form"),this.eventListeners(),this.autoPopup()}eventListeners(){this.close_link.on("keypress.Popup, click.Popup",()=>(this.close(),!1)),this.open_link.on("keypress.Popup, click.Popup",()=>("true"===document.body.getAttribute("data-popup-open")?this.close():this.open(),!1)),this.newsletter_form&&this.newsletter_form.on("submit",e=>{e.preventDefault();const t=e.target;t.querySelectorAll(".error, .success").forEach(e=>e.remove()),t.querySelectorAll('input[type="email"], [type="submit"]').forEach(e=>e.style.display="none");var o=theme.utils.parseHtml(`<p class='success'>${theme.translations.mailing_list_success_message}</p>`);return t.prepend(o),t.style.display="block",setTimeout(()=>t.submit(),500),!1})}open(){this.container.setAttribute("aria-hidden",!1),this.container.setAttribute("data-transition","forwards");var e=this.container.offsetHeight;document.body.style.paddingBottom=e+"px",document.body.setAttribute("data-popup-open",!0)}delayUntilValidScrollPosition(){window.on("DOMMouseScroll.Popup mousewheel.Popup touchmove.Popup scroll.Popup touchmove.Popup",()=>{var e=document.querySelector(".header--root").offset().top;window.pageYOffset>e&&(this.open(),window.off("DOMMouseScroll.Popup mousewheel.Popup touchmove.Popup scroll.Popup touchmove.Popup"))},{passive:!0})}close(){document.body.style.paddingBottom=0,document.body.setAttribute("data-popup-open",!1),this.container.setAttribute("data-transition","backwards"),this.container.setAttribute("aria-hidden",!0)}autoPopup(){"manual"!==this.mode&&(window.localStorage&&"test"!==this.mode?void 0!==localStorage[theme.local_storage.popup]&&!this.readyToReset()||(this.setResetTime(),setTimeout(()=>this.open(),1e3)):setTimeout(()=>this.open(),1e3))}readyToReset(){var e=JSON.parse(localStorage[theme.local_storage.popup]).popup_expires,t=(new Date).getTime();return parseFloat(e-t)<=0&&(this.setResetTime(),!0)}setResetTime(){const e=new Date;var t=864e5*this.show_again_after,o=e.setTime(e.getTime()+t);localStorage[theme.local_storage.popup]=JSON.stringify({popup_expires:o})}}customElements.define("popup-root",Popup);