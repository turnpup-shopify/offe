class ProductPickup extends HTMLElement{constructor(){super()}connectedCallback(){this.init="true"===this.getAttribute("data-load-first-variant"),this.product_title=this.getAttribute("data-title"),this.pickup_drawer_container=document.querySelector('.off-canvas--container[data-view="pickup"]'),this.root=this.closest(`[data-product-id='${this.dataset.id}']`),this.initPickup(),this.updatePickupListener()}initPickup(){this.init?this.getPickupForm(this.dataset.firstVariantId):this.parentNode.setAttribute("data-empty",!0)}updatePickupListener(){window.on("theme:product:variantChanged",({detail:{section:t,variant:e}})=>{t===this.root&&(e.available&&"shopify"===e.inventory_management?this.getPickupForm(e.id):e&&"shopify"===e.inventory_management&&e.available||this.removeOldForm())})}async getPickupForm(t){this.setAttribute("data-loading",!0);const e=await fetch(theme.urls.root+`/variants/${t}/?section_id=pickup`);if(!e.ok)throw new Error(e.statusText);var i=await e.text(),r=theme.utils.parseHtml(i,".pickup--form--container");if(this.removeOldForm(),this.setAttribute("data-loading",!1),r){this.appendChild(r),this.parentNode.setAttribute("data-empty",!1);const a=theme.utils.parseHtml(i,".pickup--drawer--container");a.querySelector(".pickup--drawer--product-title").innerText=this.product_title,"true"===this.getAttribute("data-is-only-variant")&&(a.querySelector(".pickup--drawer--variant-title").style.display="none"),this.pickup_drawer_container.appendChild(a),theme.off_canvas.reset()}}removeOldForm(){this.parentNode.setAttribute("data-empty",!0),this.pickup_drawer_container.innerHTML="",this.innerHTML=""}}const productPickupEl=customElements.get("product-pickup-root");productPickupEl||customElements.define("product-pickup-root",ProductPickup);