class Disclosure extends HTMLElement{static instances=[];constructor(){super()}connectedCallback(){Disclosure.instances.push(this),"loading"===document.readyState?window.on("DOMContentLoaded",()=>this.load()):this.load()}disconnectedCallback(){this.off("keydown.Disclosure"),this.toggle.off("click.Disclosure keydown.Disclosure focusout.Disclosure"),this.form.off("focusout.Disclosure"),this.links.off("click.Disclosure keydown.Disclosure"),this.input.off("change.Disclosure"),window.off("resize.Disclosure");var t=Disclosure.instances.indexOf(this);-1<t&&Disclosure.instances.splice(t,1)}load(){this.current_option=this.querySelector(".disclosure--current-option"),this.form=this.querySelector(".disclosure--form"),this.input=this.querySelector('[data-item="disclosure"]'),this.links=this.querySelectorAll(".disclosure--option"),this.toggle=this.querySelector(".disclosure--toggle"),this.type=this.getAttribute("data-type"),this.toggle_and_form_gap=8,this.window_and_form_gap=16,this.updateFormListeners(),this.showFormWhenClick(),this.hideFormWhenFocusOut(),this.setOptionOnClick(),this.updateFormPosition(),"option-picker"!==this.type&&this.optionChangeCallback()}updateFormListeners(){window.on("resize.Disclosure",()=>{this.animation_request&&cancelAnimationFrame(this.animation_request),this.animation_request=requestAnimationFrame(()=>this.updateFormPosition())}),this.closest(".off-canvas--left-sidebar")&&window.on("theme:offCanvas:leftOpened.Disclosure",()=>this.updateFormPosition()),this.closest(".off-canvas--right-sidebar")&&window.on("theme:offCanvas:rightOpened.Disclosure",()=>this.updateFormPosition())}showFormWhenClick(){this.toggle.on("click.Disclosure keydown.Disclosure",t=>{if("keydown"!==t.type||"Enter"===t.key){t.preventDefault();const s="true"===this.toggle.getAttribute("aria-expanded");Disclosure.instances.forEach(t=>t===this?this.toggleFormDisplay(!s):t.toggleFormDisplay(!1))}})}hideFormWhenFocusOut(){this.toggle.on("focusout.Disclosure",({relatedTarget:t})=>{this.contains(t)||this.toggleFormDisplay(!1)}),this.form.on("focusout.Disclosure",({relatedTarget:t})=>{var s=this.form.contains(t);"true"!==this.toggle.getAttribute("aria-expanded")||s||this.toggleFormDisplay(!1)}),this.on("keydown.Disclosure",({key:t})=>{"Escape"===t&&(this.toggleFormDisplay(!1),this.toggle.focus())})}setOptionOnClick(){this.links.on("click.Disclosure keydown.Disclosure",({key:t,type:s,target:e})=>{if("Enter"===t)this.toggle.focus();else if("keydown"===s)return;var i=e.dataset.value,o=e.innerHTML;this.toggleFormDisplay(!1),this.current_option.innerHTML=o,this.links.forEach(t=>t.setAttribute("aria-current",!1)),e.setAttribute("aria-current",!0),this.input.value=i,this.input.trigger("change")})}toggleFormDisplay(t){this.toggle.setAttribute("aria-expanded",t)}updateFormPosition(){this.toggle_pos=this.offset();var{height:t,width:s}=theme.utils.getHiddenDimensions(this.form);this.updateFormYPosition(t),"option-picker"!==this.type&&this.updateFormXPosition(s)}updateFormYPosition(t){var s=this.closest("[class^=off-canvas]"),e=s?s.offsetHeight:0,i=t+this.toggle_and_form_gap+this.window_and_form_gap,o=this.toggle_pos.top,r=e-o-this.toggle.offsetHeight;this.form.style.top=r<i&&r<o?`-${t+this.toggle_and_form_gap}px`:this.toggle.offsetHeight+this.toggle_and_form_gap+"px"}updateFormXPosition(t){var s=window.innerWidth-this.toggle_pos.left,e=t+this.window_and_form_gap;this.form.style.right=s<=e?this.toggle.offsetWidth+this.window_and_form_gap-s+"px":"unset"}optionChangeCallback(){this.input.on("change.Disclosure",({target:t})=>{"url-redirect"===this.type?window.location.href=t.value:"localization"===this.type&&t.closest("form").submit()})}}const disclosureEl=customElements.get("disclosure-root");disclosureEl||customElements.define("disclosure-root",Disclosure);